"use strict";var currentSlide=0,slides={},expandedImageDivContainer=$(".expanded-image-slide-show"),changeElement=function(e){$(".expanded-image-slide-show__bullets .slide-show__bullet:eq("+currentSlide+")").removeClass("active"),currentSlide=e,currentSlide>=slides.length?currentSlide=0:currentSlide<0&&(currentSlide=slides.length-1);var t=$(".expanded-image.current"),i=$(".expanded-image:not(.current)");i.attr("src",slides[currentSlide].src),t.removeClass("current"),i.addClass("current"),$(".expanded-image-counter__current").text((currentSlide+1).toString()),$(".expanded-image-slide-show__bullets .slide-show__bullet:eq("+currentSlide+")").addClass("active")},next=function(){changeElement(currentSlide+1)},previous=function(){changeElement(currentSlide-1)},close=function(){expandedImageDivContainer.removeClass("active").addClass("hiding"),setTimeout(function(){document.body.style.overflow="auto",expandedImageDivContainer.removeClass("hiding")},990),loopThroughSlideShows(startSlideShow),$(".expanded-image-slide-show__bullets").text("")},expandImageSetUp=function(e){var t=$(".expanded-image.current");loopThroughSlideShows(stopSlideShow),expandedImageDivContainer.addClass("active"),t.attr("src",e.target.src).show(),document.body.style.overflow="hidden";var i=$(e.target).attr("data-slide-colour"),a=$(e.target).data("slideShowId");slides=$(a+" .slide");for(var n=0;n<slides.length;n++)slides[n]===e.target&&(currentSlide=n),createElement($(".expanded-image-slide-show__bullets")[0],"label",{"class":"slide-show__bullet js-expanded-image-bullet slide-show__bullet--"+i,"data-slide-id":n});$(".expanded-image-counter__current").text((currentSlide+1).toString()),$(".expanded-image-counter__total").text(slides.length),slides.length>1?$(".expanded-image-slide-show__nav-previous, .expanded-image-slide-show__nav-previous, .expanded-image-slide-show__bullets").show():$(".expanded-image-slide-show__nav-previous, .expanded-image-slide-show__nav-previous, .expanded-image-slide-show__bullets").hide();var o=new RegExp("slide-show__nav--\\w*","g");$(".expanded-image-slide-show .slide-show__nav").each(function(){var e=$(this).attr("class");e=e.replace(o,"slide-show__nav--"+i),$(this).attr("class",e)}),$(".expanded-image-slide-show__bullets .slide-show__bullet:eq("+currentSlide+")").addClass("active"),$(".modal--detailed-project").removeClass("open").hide(),setTimeout(function(){t.attr("src",""),t.attr("src",e.target.src)},1e3)};$(document).on("ready",function(){$("body").on("click",".js-expandable-image",expandImageSetUp),$("body").on("click",".js-expanded-image-bullet",function(e){changeElement(parseInt($(e.target).data("slideId")))}),$(".expanded-image-slide-show__close").click(close),$(".expanded-image-slide-show__nav-next").click(next),$(".expanded-image-slide-show__nav-previous").click(previous)});var autoSlide={},resetTransition=function(e){e.css("transitionDuration","2s")},widenSlideShow=function(e){var t=e.innerWidth()*e.children().first().children().length;e.children().first().css("width",t+"px")},repositionSlides=function(e){var t=$("#"+e+" .slide-show__slides-container");widenSlideShow($("#"+e+" .slide-show__viewpoint")),t.children().css("width",$("#"+e).innerWidth()+"px");var i=$("#"+e+" .slide-show__slide-container.active").position();t.css({transitionDuration:"0s",left:"-"+i.left+"px"}),setTimeout(resetTransition,100,t)},startSlideShow=function(e){$("#"+e+" .slide-show__slides-container").children().length>1&&(autoSlide["#"+e]=setInterval(function(){moveSlide("#"+e,"next")},5e3))},stopSlideShow=function(e){clearInterval(autoSlide["#"+e])},loopThroughSlideShows=function(e){var t,i=$(".hasSlideShow");for(t=0;t<i.length;t++)e(i[t].id)},fixSlides=function(){var e=setInterval(loopThroughSlideShows,10,repositionSlides);setTimeout(function(){clearInterval(e)},1e3)},moveToSlide=function(e,t){var i=$(e+" .slide-show__slides-container");if(clearInterval(autoSlide[e]),resetTransition(i),"#slide-show--projects-preview"==e){var a=t.filter(".slide-show__slide-container").attr("data-slide-colour"),n=new RegExp("slide-show__nav--\\w*","g");$(e+" .slide-show__nav").each(function(){var e=$(this).attr("class");e=e.replace(n,"slide-show__nav--"+a),$(this).attr("class",e)}),$(e+" .slide-show__viewpoint").height(t.children().filter(".slide").height())}$(e+" .active").removeClass("active");var o=t.position();t.addClass("active");var r=t[0].id;i.css("left","-"+o.left+"px"),$(e+" .slide-show__bullet[data-slide-id="+r+"]").addClass("active"),autoSlide[e]=setInterval(function(){moveSlide(e,"next")},5e3)},moveSlide=function(e,t){var i,a=$(e+" .active");i="next"===t?a.next().length>0?a.next():a.parent().children().first():a.prev().length>0?a.prev():a.parent().children().last(),moveToSlide(e,i)},changeToSlide=function(){var e=$(this).data("slideShowId"),t=$(this).data("slideId"),i=$(e+" #"+t);moveToSlide(e,i)},resetToCurrentSlide=function(e){var t=$(e+" .slide-show__slide-container.active").position(),i=$(e+" .slide-show__slides-container");i.css({transitionDuration:"0s",left:"-"+t.left+"px"}),setTimeout(resetTransition,100,i),autoSlide[e]=setInterval(function(){moveSlide(e,"next")},5e3)},dragStart=function(e){var t=$(this).data("slideShowId"),i=e.changedTouches?e.changedTouches[0].clientX:e.clientX,a=$(t+" .slide-show__slides-container"),n=a.css("left"),o=$(t+" .slide-show__viewpoint"),r=function(e){var t=i-(e.changedTouches?e.changedTouches[0].clientX:e.clientX),o=parseInt(n);o||(o=0),a.css({transitionDuration:"0s",left:o-t+"px"})},s=function(e){var a=e.changedTouches?e.changedTouches[0].clientX:e.clientX;i-a>15?moveSlide(t,"next"):i-a<-15?moveSlide(t,"previous"):resetToCurrentSlide(t),o[0].removeEventListener("touchmove",r),o[0].removeEventListener("touchend",s),o[0].removeEventListener("mousemove",r),o[0].removeEventListener("mouseup",s),o[0].removeEventListener("mouseleave",l)},l=function(){resetToCurrentSlide(t),o[0].removeEventListener("touchmove",r),o[0].removeEventListener("touchend",s),o[0].removeEventListener("mousemove",r),o[0].removeEventListener("mouseup",s),o[0].removeEventListener("mouseleave",l)};clearInterval(autoSlide[t]),o[0].addEventListener("touchmove",r),o[0].addEventListener("touchend",s),o[0].addEventListener("mousemove",r),o[0].addEventListener("mouseup",s),o[0].addEventListener("mouseleave",l)},setUpSlideShow=function(e){var t=$(e+" .slide-show__viewpoint"),i=$(e+" .slide-show__slide-container");$(e).addClass("hasSlideShow").show(),widenSlideShow(t),i.length>1?(i.css("width",t.innerWidth()+"px"),$(e+" .moveSlide, "+e+" .slideShowBullets").show(),autoSlide[e]=setInterval(function(){moveSlide(e,"next")},5e3),t[0].addEventListener("mousedown",dragStart),t[0].addEventListener("touchstart",dragStart)):$(e+" .moveSlide, "+e+" .slideShowBullets").hide(),i.first().addClass("active"),$(e+" .slide-show__bullet:first").addClass("active"),"#slide-show--projects-preview"==e&&$(e+" .slide-show__viewpoint").height(i.first().children().filter(".slide").height())};$(document).on("ready",function(){$(window).on("orientationchange resize",fixSlides),$("body").on("click",".js-slide-show-bullet",changeToSlide),$("body").on("click",".moveSlide",function(){moveSlide($(this).data("slideShowId"),$(this).data("navDirection"))}),$("body").on("dragstart",".slide",!1)});var checkInputField=function(e){return""===e.value.trim()?(e.classList.add("invalid"),!1):(e.classList.remove("invalid"),!0)},createElement=function(e,t,i){var a=document.createElement(t);for(var n in i)i.hasOwnProperty(n)&&("innerHTML"===n?a[n]=i[n]:a.setAttribute(n,i[n]));return e.appendChild(a),a},checkFeedback=function(e,t,i){(e||i)&&t(e||i)},loopThroughData=function(e,t,i,a){var n;if(e.rows&&e.rows.length>0){for(n=0;n<e.rows.length;n++)e.rows.hasOwnProperty(n)&&t(e.rows[n]);return!0}return checkFeedback(e.meta.feedback,i,a),!1},encodePayload=function(e){var t,i="";for(t in e)e.hasOwnProperty(t)&&(i+=t+"="+encodeURIComponent(e[t])+"&",i=i.replace("%20","+"),i=i.replace("%3D","="));return i.slice(0,-1)},sendRequest=function(e){var t=new XMLHttpRequest;e.query&&"file"!==e.data&&(e.query=encodePayload(e.query),"POST"!==e.method&&(e.url+="?"+e.query)),t.open(e.method,e.url,!0),t.setRequestHeader("Accept","application/json"),e.query&&"POST"===e.method&&"file"!==e.data&&t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.addEventListener("load",function(){if(this&&""!==this.responseText)try{var t=JSON.parse(this.responseText);e.load(t)}catch(i){e.error("Error Loading Content.")}else e.error("Error Loading Content.")}),t.addEventListener("error",function(){e.error("Error Loading Content.")}),t.send(e.query)},url=new URL(window.location),renderError=function(e){$(".error").text(e).show("fast"),$(".projects-loading-img, .pagination").text("").hide("fast"),delayExpand()},addSkills=function(e,t){for(var i=e.Skills.split(","),a=$(t+" .project__skills")[0],n=0;n<i.length;n++)if(""!==i[n].trim())for(var o=createElement(a,"p",{innerHTML:i[n],"class":"js-searchable-skill skill skill--"+e.Colour}),r=$(".search-input")[0].value.split(" "),s=0;s<r.length;s++)""!==r[s].trim()&&i[n].toLowerCase().includes(r[s].toLowerCase())&&(o.className+=" searched")},addLinks=function(e,t){var i=$(t+" .project__links")[0];e.Link&&createElement(i,"a",{href:e.Link,title:"Link to "+e.Name+" Site",target:"_blank",innerHTML:"View","class":"project__link project__link--"+e.Colour}),e.Download&&createElement(i,"a",{href:e.Download,title:"Link to Download "+e.Name,target:"_blank",innerHTML:"Download","class":"project__link project__link--"+e.Colour}),createElement(i,"a",{href:e.GitHub,title:"Link to "+e.Name+"  Code On GitHub",target:"_blank",innerHTML:"GitHub","class":"project__link project__link--"+e.Colour})},addProjectPictures=function(e,t){for(var i=$(t+" .slide-show__slides-container"),a=$(t+" .slideShowBullets"),n=0;n<e.pictures.length;n++)if(e.pictures.hasOwnProperty(n)){var o=jQuery("#tmpl-slide-template").text(),r=jQuery("#tmpl-slide-bullet-template").text();for(var s in e.pictures[n])if(e.pictures[n].hasOwnProperty(s)&&"string"==typeof s){var l=new RegExp("{{"+s+"}}","g");o=o.replace(l,e.pictures[n][s]),r=r.replace(l,e.pictures[n][s])}var d=new RegExp("{{Colour}}","g");o=o.replace(d,e.Colour),r=r.replace(d,e.Colour);var c=new RegExp("{{Slide-Show-ID}}","g");r=r.replace(c,t),i.append(o),a.append(r)}e.pictures.length>0&&setUpSlideShow(t)},renderProject=function(e){if(!document.getElementById("project--"+e.ID)){var t=jQuery("#tmpl-project-template").text();for(var i in e)if(e.hasOwnProperty(i)&&"string"==typeof i){var a=new RegExp("{{"+i+"}}","g");t=t.replace(a,e[i])}$(".projects").append(t),addSkills(e,"#project--"+e.ID),addLinks(e,"#project--"+e.ID),addProjectPictures(e,"#slide-show--"+e.ID),$("#project--"+e.ID+" .viewMoreButton").data("projectData",e)}delayExpand()},scrollToProjects=function(){$("html, body").animate({scrollTop:jQuery(".projects").offset().top-jQuery(".nav").height()},2e3)},addPagination=function(e){if(parseInt(e)>10){var t=1,i=$(".pagination")[0],a=url.pathname.substring(1).split("/");if(Number.isInteger(parseInt(a[1])))var n=parseInt(a[1]);n||(n=1);for(var o=0;o<e;o+=10,t++){var r={innerHTML:t,"class":"pagination__item"};t===n&&(r["class"]+=" active"),createElement(i,"li",r)}$(".pagination").show()}else $(".pagination").hide()},gotProjects=function(e){$(".error, .projects-loading-img").text("").hide("fast"),$(".projects, .pagination").text(""),loopThroughData(e,renderProject,renderError,"No Projects Found."),e.count&&addPagination(e.count),delayExpand()},getProjects=function(e){loopThroughSlideShows(stopSlideShow),$(".projects-loading-img").show("fast"),sendRequest({method:"GET",url:"/admin/api/1/projects/",query:e,load:gotProjects,error:renderError})},doSearch=function(){var e={};return url.pathname="/projects/",""!==$(".search-input")[0].value.trim()?(url.search="?search="+$(".search-input")[0].value,e.search=$(".search-input")[0].value):$(".search-input")[0].value=url.search="",history.pushState(null,null,url.toString()),getProjects(e),!1},getSearch=function(){for(var e=url.search.substring(1).split("&"),t=/\bsearch=/im,i=0;i<e.length;i++){var a=t.test(e[i]);if(a){var n=e[i].split("=");return decodeURIComponent(n[1])}}},load=function(){var e={},t=url.pathname.substring(1).split("/");t[1]&&Number.isInteger(parseInt(t[1]))&&(e.page=parseInt(t[1]));var i=getSearch();i?e.search=$(".search-input")[0].value=i:$(".search-input").val(""),getProjects(e)},setUp=function(){$(".projects").length>0&&($(".search-form").submit(doSearch),load(),$("body").on("click",".js-searchable-skill",function(e){$(".search-input")[0].value=e.target.innerHTML,doSearch()}),$(".pagination--projects").on("click",".pagination__item",function(e){scrollToProjects(),url.pathname="/projects/"+e.target.innerHTML+"/",history.pushState(null,null,url.toString()),load()}),$(".projects").on("click",".viewMoreButton",function(){var e=$(this).data("projectData");$(".modal--detailed-project").addClass("open").show(),document.body.style.overflow="hidden",loopThroughSlideShows(stopSlideShow),$(".modal--detailed-project .project__links, .modal--detailed-project .project__skills, .modal--detailed-project .slide-show__slides-container, .modal--detailed-project .slideShowBullets").text(""),$(".modal--detailed-project .project-title").text(e.Name),$(".modal--detailed-project .project-date").text(e.Date),addSkills(e,".modal--detailed-project"),$(".modal--detailed-project .description").html(e.LongDescription),addLinks(e,".modal--detailed-project"),addProjectPictures(e,"#detailed-project__slide-show");var t=new RegExp("slide-show__nav--\\w*","g");$(".modal--detailed-project .slide-show__nav").each(function(){var i=$(this).attr("class");i=i.replace(t,"slide-show__nav--"+e.Colour),$(this).attr("class",i)})}))};window.addEventListener("load",setUp),window.addEventListener("popstate",function(){url=new URL(window.location),scrollToProjects(),load()}),$(".modal--detailed-project").click(function(e){!$(e.target).closest(".modal__content").length&&$(".modal--detailed-project").hasClass("open")&&($(".modal--detailed-project").removeClass("open").hide(),document.body.style.overflow="auto",$("#detailed-project__slide-show .slide-show__viewpoint")[0].removeEventListener("mousedown",dragStart),$("#detailed-project__slide-show .slide-show__viewpoint")[0].removeEventListener("touchstart",dragStart),$("#detailed-project__slide-show .slide-show__slides-container").css("left","0px"),clearInterval(autoSlide["#detailed-project__slide-show"]),$("#detailed-project__slide-show").removeClass("hasSlideShow"),loopThroughSlideShows(startSlideShow))});var renderProjectsPreviewError=function(e){$(".error").text(e).show("fast"),$(".projects-loading-img").hide("fast"),delayExpand()},renderProjectPreview=function(e){var t=jQuery("#tmpl-slide-template").text(),i=jQuery("#tmpl-slide-bullet-template").text();for(var a in e)if(e.hasOwnProperty(a)&&"string"==typeof a){var n=new RegExp("{{"+a+"}}","g");t=t.replace(n,e[a]),i=i.replace(n,e[a])}var o=new RegExp("{{File}}","g");t=t.replace(o,e.pictures[0].File),$(".slide-show__slides-container").append(t),$(".slideShowBullets").append(i);var r=$("#slide"+e.ID+" .project-description__links")[0];e.Link&&createElement(r,"a",{href:e.Link,innerHTML:"View","class":"btn btn--clear projectPreLink",target:"_blank"}),createElement(r,"a",{href:e.GitHub,innerHTML:"GitHub","class":"btn btn--clear projectPreGitHub",target:"_blank"})},gotProjectsPreview=function(e){$(".error, .projects-loading-img").text("").hide("fast");var t=loopThroughData(e,renderProjectPreview,renderProjectsPreviewError,"Error Getting the Projects.");t&&setUpSlideShow("#slide-show--projects-preview"),delayExpand()};$(document).on("ready",function(){$("#slide-show--projects-preview").length>0&&($(".projects-loading-img").show("fast"),sendRequest({method:"GET",url:"/admin/api/1/projects/",query:{limit:3},load:gotProjectsPreview,error:renderProjectsPreviewError}))});var renderFeedback=function(e){$("#formFeedback").show("fast").text(e.feedback),e.ok?($("#formFeedback").addClass("success"),$("#emailInput, #messageInput, #subjectInput").val("")):(e.feedback&&$("#formFeedback").addClass("error"),e.messageFeedback&&$("#messageFeedback").show("fast").text(e.messageFeedback),e.emailAddressFeedback&&$("#emailAddressFeedback").show("fast").text(e.emailAddressFeedback)),$("#submit").prop("disabled",!1).html($("#submit").data("initialText"))},renderErrorMessage=function(){$("#formFeedback").show("fast").text("Something went wrong, please try again later.").addClass("error"),$("#submit").prop("disabled",!1).html($("#submit").data("initialText"))},validateForm=function(){$("#submit").prop("disabled",!0).html($("#submit").data("loadingText"));var e=validateMessage($("#messageInput").val(),!0),t=validateEmail($("#emailInput").val(),!0);return t&&e?sendRequest({method:"POST",url:"sendMessage.php",query:{emailAddress:emailInput.value,message:messageInput.value,subject:subjectInput.value},load:renderFeedback,error:renderErrorMessage}):$("#submit").prop("disabled",!1).html($("#submit").data("initialText")),!1},validateEmail=function(e,t){$("#formFeedback").hide("fast");var i=/\b[\w._-]+@[\w-]+.[\w]{2,}\b/im,a=i.test(e);if(""===e.trim()&&t)$("#emailInput").addClass("invalid"),$("#emailFeedback").show("fast").text("Email Address must be provided and valid.");else if(!a&&t)$("#emailInput").addClass("invalid"),$("#emailFeedback").show("fast").text("Email Address must be valid.");else if(""!==e.trim()&&a)return $("#emailInput").removeClass("invalid"),$("#emailFeedback").hide("fast"),!0;return!1},validateMessage=function(e,t){return $("#formFeedback").hide("fast"),""===e.trim()&&t?($("#messageInput").addClass("invalid"),$("#messageFeedback").show("fast").text("Message must be filled out."),!1):""!==e.trim()?($("#messageInput").removeClass("invalid"),$("#messageFeedback").hide("fast"),!0):void 0};$("#subjectInput").keyup(function(){$("#formFeedback").hide("fast")});var expandSection=function(){$("section").height("auto");var e=$("header").outerHeight(!0)+$("section").outerHeight(!0)+$("footer").outerHeight(!0);e<$(window).height()&&$("section").height($(window).height()-e+$("section").height())},delayExpand=function(){var e=setInterval(expandSection,100);setTimeout(function(){clearInterval(e)},2500)};$(window).on("load orientationchange resize",expandSection),$(document).click(function(e){$(e.target).closest(".nav").length||$(".nav__links-container").hasClass("closed")||"none"===$(".nav__links__toggle").css("display")||$(".nav__links__toggle").trigger("click")}),$(".nav__links__toggle").on("click",function(){var e=$(".nav__links-container");if(e.toggleClass("closed"),e.toggleClass("opening"),e[0].clientHeight)e[0].style.height=0;else{var t=$(".nav__links")[0];e[0].style.height=t.clientHeight+"px"}setTimeout(function(){e.toggleClass("opening")},670),$(".nav").toggleClass("opened")}),$(window).on("orientationchange resize",function(){if($(window).width()>768){var e=$(".nav__links-container");e[0].style.height="",e.addClass("closed"),$(".nav").removeClass("opened"),e.removeClass("opening")}}),$(window).on("scroll",function(){var e=$(".nav").height(),t=$(window).scrollTop()+e,i=$(window).height();t>=i?$(".nav").addClass("scrolled"):$(".nav").removeClass("scrolled")}),$(document).on("ready",function(){$(".js-scroll-to-content").on("click",function(){$("html, body").animate({scrollTop:jQuery("section").offset().top-jQuery(".nav").height()},1e3)})});